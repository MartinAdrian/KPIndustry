{% extends 'homepage.html' %}

{% block content2 %}

  <form method="post">
    {% csrf_token %}
    <table class="content-table">
      <tr>
        <th colspan="6" style="background-color: rgba(0,0,0,0.2)">
          Edit Info
        </th>
      </tr>
      <tr>
        {% for field in form %}
          <th> {{ field.label }} </th>
        {% endfor %}
          <th>Action</th>
      </tr>
      <tr>
        {% for field in form %}
          {% if field.label == 'User Type' %}
            <td>
              <select class="choose-box" name="user_type" style="width: calc(100% - 3px)" required>
                {% if field.value == "Tester" %}
                  <option value="Tester" selected="selected">Tester</option>
                {% else %}
                  <option value="Tester">Tester</option>
                {% endif %}
                {% if field.value == "Lead Tester" %}
                  <option value="Lead Tester" selected="selected">Lead Tester</option>
                {% else %}
                  <option value="Lead Tester">Lead Tester</option>
                {% endif %}
                {% if field.value == "Project Manager" %}
                  <option value="Project Manager" selected="selected">Project Manager</option>
                {% else %}
                  <option value="Project Manager">Project Manager</option>
                {% endif %}
                {% if field.value == "Administrator" %}
                  <option value="Administrator" selected="selected">Administrator</option>
                {% else %}
                  <option value="Administrator">Administrator</option>
                {% endif %}
              </select>
            </td>
          {% else %}
            <td>
              <input class="form-control add-box" type="text" name="{{ field.html_name }}" autocomplete="off" required value="{{ field.value }}">
            </td>
          {% endif %}
        {% endfor %}
          <td><button style="width: 50px" class="box-btn" type="submit">Modify</button></td>
      </tr>
    </table>
  </form>
  <div style="height: 5px"></div>
  <table class="content-table">
    <tr>
      <th colspan="8" style="background-color: rgba(0,0,0,0.2)">
        Manage Database
      </th>
    </tr>
    <tr>
      <th>Index</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>eMail</th>
      <th>Username</th>
      <th>User Type</th>
      <th>Active</th>
      <th>Action</th>
    </tr>
    <tbody>
      {% for item in objects %}
        <tr style="height: 42px">
          <td>{{item.id}}</td>
          <td>{{item.first_name}}</td>
          <td>{{item.last_name}}</td>
          <td>{{item.email}}</td>
          <td>{{item.username}}</td>
          <td>{{item.user_type}}</td>
          <td>{{item.is_active}}</td>
          <td style="max-width: 75px; width: 75px">
            {% if item.first_name != request.user.first_name %}
              {% if form.first_name.value in item.first_name and form.last_name.value in item.last_name %}
                <p class="action-err-txt">Current</p>
                <p class="action-err-txt">Edit</p>
              {% else %}
                <table class="custom-table" style="border-collapse: collapse; width: 100%">
                  <tr>
                    <td style="padding: 0px">
                      <a class="edit-btn" href="{% url 'KPIndustry:update-user' item.id %}">
                        Edit
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <td style="padding: 0px">
                      {% if item.is_active == True %}
                      <a class="deactivate-btn" href="{% url 'KPIndustry:deactivate-user' item.id %}">Deactivate</a>
                      {% else %}
                      <a class="reactivate-btn" href="{% url 'KPIndustry:reactivate-user' item.id %}">Reactivate</a>
                      {% endif %}
                    </td>
                  </tr>
                </table>
              {% endif %}
            {% else %}
              <p class="action-err-txt">Current</p>
              <p class="action-err-txt">Login</p>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

{% endblock %}